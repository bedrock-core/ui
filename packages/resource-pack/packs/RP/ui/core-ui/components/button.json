{
	"namespace": "core-ui_components",
	"button": {
		"type": "panel",
		// Note: from size_binding_x/y seems relative to parent size so making parent 10x10 will be 10 times larger the child
		"size": [
			1,
			1
		],
		"controls": [
			{
				"button@controlled_button": {}
			},
			{
				"disabled_button@disabled_button": {}
			}
		]
	},
	"controlled_button": {
		"type": "button",
		"size": [
			0,
			0
		],
		"anchor_from": "top_left",
		"anchor_to": "top_left",
		"use_anchored_offset": true,
		"property_bag": {
			"#size_binding_x": 0.0,
			"#size_binding_y": 0.0,
			"#anchored_offset_value_x": 0.0,
			"#anchored_offset_value_y": 0.0
		},
		"visible": "#visible",
		"$normalize": 1.0,
		"bindings": [
			{
				"binding_type": "collection_details",
				"binding_collection_name": "form_buttons"
			},
			{
				"binding_name": "#form_button_text",
				"binding_type": "collection",
				"binding_collection_name": "form_buttons"
			},
			{
				/* --- strip protocol header (9 chars) --- */
				"binding_type": "view", // protocol header size
				"source_property_name": "('%.9s' * #form_button_text)",
				"target_property_name": "#protocol_header"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#form_button_text - #protocol_header)",
				"target_property_name": "#rem_after_header"
			},
			{
				/* --- type (string) - field 0 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.83s' * #rem_after_header)",
				"target_property_name": "#raw_type"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_header - #raw_type)",
				"target_property_name": "#rem_after_type"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.82s' * #raw_type) - ('%.2s' * #raw_type) - ';')",
				"target_property_name": "#type"
			},
			{
				/* --- width (int) - field 1 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_type)",
				"target_property_name": "#raw_width"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_type - #raw_width)",
				"target_property_name": "#rem_after_width"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.26s' * #raw_width) - ('%.2s' * #raw_width) - ';')",
				"target_property_name": "#size_binding_x"
			},
			{
				/* --- height (int) - field 2 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_width)",
				"target_property_name": "#raw_height"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_width - #raw_height)",
				"target_property_name": "#rem_after_height"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.26s' * #raw_height) - ('%.2s' * #raw_height) - ';')",
				"target_property_name": "#size_binding_y"
			},
			{
				/* --- x (int) - field 3 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_height)",
				"target_property_name": "#raw_x"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_height - #raw_x)",
				"target_property_name": "#rem_after_x"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "((('%.26s' * #raw_x) - ('%.2s' * #raw_x) - ';') * $normalize)",
				"target_property_name": "#anchored_offset_value_x"
			},
			{
				/* --- y (float) - field 4 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_x)",
				"target_property_name": "#raw_y"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_x - #raw_y)",
				"target_property_name": "#rem_after_y"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "((('%.26s' * #raw_y) - ('%.2s' * #raw_y) - ';') * $normalize)",
				"target_property_name": "#anchored_offset_value_y"
			},
			{
				/* --- visible (boolean) - field 5 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.8s' * #rem_after_y)",
				"target_property_name": "#raw_visible"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_y - #raw_visible)",
				"target_property_name": "#rem_after_visible"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width (s:) - padding_char (;)
				"source_property_name": "(('%.7s' * #raw_visible) - ('%.2s' * #raw_visible) - ';')",
				"target_property_name": "#pre_visible"
			},
			{
				/* --- enabled (boolean) - field 6 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.8s' * #rem_after_visible)",
				"target_property_name": "#raw_enabled"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_visible - #raw_enabled)",
				"target_property_name": "#rem_after_enabled"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.7s' * #raw_enabled) - ('%.2s' * #raw_enabled) - ';')",
				"target_property_name": "#enabled"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#pre_visible and (#type = 'button') and #enabled)",
				"target_property_name": "#visible"
			}
		],
		// === Base button functionality (from vanilla_button) ===
		"$focus_id|default": "",
		"$focus_override_down|default": "",
		"$focus_override_up|default": "",
		"$focus_override_left|default": "",
		"$focus_override_right|default": "",
		"focus_identifier": "$focus_id",
		"focus_change_down": "$focus_override_down",
		"focus_change_up": "$focus_override_up",
		"focus_change_left": "$focus_override_left",
		"focus_change_right": "$focus_override_right",
		"focus_enabled": true,
		"focus_magnet_enabled": true,
		"focus_wrap_enabled": true,
		"default_focus_precedence": 0,
		"sound_name": "random.click",
		"sound_volume": 1.0,
		"sound_pitch": 1.0,
		"locked_control": "locked",
		"default_control": "default",
		"hover_control": "hover",
		"pressed_control": "pressed",
		"$default_state|default": false,
		"$hover_state|default": false,
		"$pressed_state|default": false,
		"$locked_state|default": false,
		"button_mappings": [
			{
				"from_button_id": "button.menu_select",
				"to_button_id": "button.form_button_click",
				"mapping_type": "pressed"
			},
			{
				"from_button_id": "button.menu_ok",
				"to_button_id": "button.form_button_click",
				"mapping_type": "focused"
			}
		],
		"controls": [
			{
				"default": {
					"type": "panel",
					"layer": 1,
					"size": [
						"100%",
						"100%"
					],
					"anchor_to": "center",
					"anchor_from": "center",
					"controls": [
						{
							"button_image@button_image": {}
						}
					],
					"$button_texture": "textures/ui/core-ui/components/button/primary/background",
					"$default_state": true
				}
			},
			{
				"hover": {
					"type": "panel",
					"layer": 4,
					"size": [
						"100%",
						"100%"
					],
					"anchor_to": "center",
					"anchor_from": "center",
					"controls": [
						{
							"button_image@button_image": {}
						}
					],
					"$button_texture": "textures/ui/core-ui/components/button/primary/background_hover",
					"$hover_state": true
				}
			},
			{
				"pressed": {
					"type": "panel",
					"layer": 5,
					"size": [
						"100%",
						"100%"
					],
					"anchor_to": "center",
					"anchor_from": "center",
					"controls": [
						{
							"button_image@button_image": {}
						}
					],
					"$button_texture": "textures/ui/core-ui/components/button/primary/background_pressed",
					"$pressed_state": true,
					"$button_offset|default": [
						0,
						1
					]
				}
			}
		]
	},
	"disabled_button": {
		"type": "panel",
		"size": [
			0,
			0
		],
		"anchor_from": "top_left",
		"anchor_to": "top_left",
		"use_anchored_offset": true,
		"property_bag": {
			"#size_binding_x": 0.0,
			"#size_binding_y": 0.0,
			"#anchored_offset_value_x": 0.0,
			"#anchored_offset_value_y": 0.0
		},
		"visible": "#visible",
		"$normalize": 1.0,
		"bindings": [
			{
				"binding_type": "collection_details",
				"binding_collection_name": "form_buttons"
			},
			{
				"binding_name": "#form_button_text",
				"binding_type": "collection",
				"binding_collection_name": "form_buttons"
			},
			{
				/* --- strip protocol header (9 chars) --- */
				"binding_type": "view", // protocol header size
				"source_property_name": "('%.9s' * #form_button_text)",
				"target_property_name": "#protocol_header"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#form_button_text - #protocol_header)",
				"target_property_name": "#rem_after_header"
			},
			{
				/* --- type (string) - field 0 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.83s' * #rem_after_header)",
				"target_property_name": "#raw_type"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_header - #raw_type)",
				"target_property_name": "#rem_after_type"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.82s' * #raw_type) - ('%.2s' * #raw_type) - ';')",
				"target_property_name": "#type"
			},
			{
				/* --- width (int) - field 1 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_type)",
				"target_property_name": "#raw_width"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_type - #raw_width)",
				"target_property_name": "#rem_after_width"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.26s' * #raw_width) - ('%.2s' * #raw_width) - ';')",
				"target_property_name": "#size_binding_x"
			},
			{
				/* --- height (int) - field 2 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_width)",
				"target_property_name": "#raw_height"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_width - #raw_height)",
				"target_property_name": "#rem_after_height"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.26s' * #raw_height) - ('%.2s' * #raw_height) - ';')",
				"target_property_name": "#size_binding_y"
			},
			{
				/* --- x (int) - field 3 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_height)",
				"target_property_name": "#raw_x"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_height - #raw_x)",
				"target_property_name": "#rem_after_x"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "((('%.26s' * #raw_x) - ('%.2s' * #raw_x) - ';') * $normalize)",
				"target_property_name": "#anchored_offset_value_x"
			},
			{
				/* --- y (float) - field 4 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.27s' * #rem_after_x)",
				"target_property_name": "#raw_y"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_x - #raw_y)",
				"target_property_name": "#rem_after_y"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "((('%.26s' * #raw_y) - ('%.2s' * #raw_y) - ';') * $normalize)",
				"target_property_name": "#anchored_offset_value_y"
			},
			{
				/* --- visible (boolean) - field 5 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.8s' * #rem_after_y)",
				"target_property_name": "#raw_visible"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_y - #raw_visible)",
				"target_property_name": "#rem_after_visible"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width (s:) - padding_char (;)
				"source_property_name": "(('%.7s' * #raw_visible) - ('%.2s' * #raw_visible) - ';')",
				"target_property_name": "#pre_visible"
			},
			{
				/* --- enabled (boolean) - field 6 --- */
				"binding_type": "view", // full_width
				"source_property_name": "('%.8s' * #rem_after_visible)",
				"target_property_name": "#raw_enabled"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#rem_after_visible - #raw_enabled)",
				"target_property_name": "#rem_after_enabled"
			},
			{
				"binding_type": "view", // (full_width - marker_width) - prefix_width - padding_char (;)
				"source_property_name": "(('%.7s' * #raw_enabled) - ('%.2s' * #raw_enabled) - ';')",
				"target_property_name": "#enabled"
			},
			{
				"binding_type": "view",
				"source_property_name": "(#pre_visible and (#type = 'button') and (not #enabled))",
				"target_property_name": "#visible"
			}
		],
		"controls": [
			{
				"locked": {
					"type": "panel",
					"layer": 1,
					"size": [
						"100%",
						"100%"
					],
					"anchor_to": "center",
					"anchor_from": "center",
					"controls": [
						{
							"button_image@button_image": {}
						}
					],
					"$button_texture": "textures/ui/core-ui/components/button/disabled/background"
				}
			}
		]
	},
	"button_image": {
		"type": "image",
		// TODO reminder for myself to know this is possible
		// "ignored": "(not $button_image_visible)",
		"size": [
			"100% - 2px",
			"100% - 2px"
		],
		"offset": [
			0,
			0
		],
		"layer": 1,
		"fill": false,
		"color": [
			1.0,
			1.0,
			1.0
		],
		"anchor_to": "center",
		"anchor_from": "center",
		"texture": "$button_texture",
		"alpha": 1
	}
}